{"ast":null,"code":"import _objectWithoutProperties from\"/Users/midmoussi/Documents/smart_port/daml-ui-template/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import React,{useEffect}from\"react\";import{HashRouter,Route,Switch,Redirect}from\"react-router-dom\";import{damlPartyKey,damlTokenKey}from\"../config\";import{useUserState,useUserDispatch}from\"../context/UserContext\";import Layout from\"./Layout/Layout\";import ErrorComponent from\"../pages/error/Error\";import Login from\"../pages/login/Login\";export default function App(){var userState=useUserState();return/*#__PURE__*/React.createElement(HashRouter,null,/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/\",component:RootRoute}),/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/app\",render:function render(){return/*#__PURE__*/React.createElement(Redirect,{to:\"/app/report\"});}}),/*#__PURE__*/React.createElement(PrivateRoute,{path:\"/app\",component:Layout}),/*#__PURE__*/React.createElement(PublicRoute,{path:\"/login\",component:Login}),/*#__PURE__*/React.createElement(Route,{component:ErrorComponent})));// #######################################################################\nfunction RootRoute(){var userDispatch=useUserDispatch();useEffect(function(){var url=new URL(window.location.toString());var token=url.searchParams.get('token');if(token===null){return;}var party=url.searchParams.get('party');if(party===null){throw Error(\"When 'token' is passed via URL, 'party' must be passed too.\");}localStorage.setItem(damlPartyKey,party);localStorage.setItem(damlTokenKey,token);userDispatch({type:\"LOGIN_SUCCESS\",token:token,party:party});});return/*#__PURE__*/React.createElement(Redirect,{to:\"/app/report\"});}function PrivateRoute(_ref){var component=_ref.component,rest=_objectWithoutProperties(_ref,[\"component\"]);return/*#__PURE__*/React.createElement(Route,Object.assign({},rest,{render:function render(props){return userState.isAuthenticated?React.createElement(component,props):/*#__PURE__*/React.createElement(Redirect,{to:{pathname:\"/login\",state:{from:props.location}}});}}));}function PublicRoute(_ref2){var component=_ref2.component,rest=_objectWithoutProperties(_ref2,[\"component\"]);return/*#__PURE__*/React.createElement(Route,Object.assign({},rest,{render:function render(props){return userState.isAuthenticated?/*#__PURE__*/React.createElement(Redirect,{to:{pathname:\"/\"}}):React.createElement(component,props);}}));}}","map":{"version":3,"sources":["/Users/midmoussi/Documents/smart_port/daml-ui-template/ui/src/components/App.tsx"],"names":["React","useEffect","HashRouter","Route","Switch","Redirect","damlPartyKey","damlTokenKey","useUserState","useUserDispatch","Layout","ErrorComponent","Login","App","userState","RootRoute","userDispatch","url","URL","window","location","toString","token","searchParams","get","party","Error","localStorage","setItem","type","PrivateRoute","component","rest","props","isAuthenticated","createElement","pathname","state","from","PublicRoute"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\nimport { HashRouter, Route, Switch, Redirect } from \"react-router-dom\";\nimport { damlPartyKey, damlTokenKey } from \"../config\";\nimport { useUserState, useUserDispatch } from \"../context/UserContext\";\nimport Layout from \"./Layout/Layout\";\nimport ErrorComponent from \"../pages/error/Error\";\nimport Login from \"../pages/login/Login\";\n\nexport default function App() {\n  const userState = useUserState();\n\n  return (\n    <HashRouter>\n      <Switch>\n        <Route exact path=\"/\" component={RootRoute} />\n        <Route\n          exact\n          path=\"/app\"\n          render={() => <Redirect to=\"/app/report\" />}\n        />\n        <PrivateRoute path=\"/app\" component={Layout} />\n        <PublicRoute path=\"/login\" component={Login} />\n        <Route component={ErrorComponent} />\n      </Switch>\n    </HashRouter>\n  );\n\n  // #######################################################################\n\n  function RootRoute() {\n    const userDispatch = useUserDispatch();\n\n    useEffect(() => {\n      const url = new URL(window.location.toString());\n      const token = url.searchParams.get('token');\n      if (token === null) {\n        return;\n      }\n      const party = url.searchParams.get('party');\n      if (party === null) {\n        throw Error(\"When 'token' is passed via URL, 'party' must be passed too.\");\n      }\n      localStorage.setItem(damlPartyKey, party);\n      localStorage.setItem(damlTokenKey, token);\n\n      userDispatch({ type: \"LOGIN_SUCCESS\", token, party });\n    })\n\n    return (\n      <Redirect to=\"/app/report\" />\n    )\n  }\n\n  function PrivateRoute({ component, ...rest } : any) {\n    return (\n      <Route\n        {...rest}\n        render={props =>\n          userState.isAuthenticated ? (\n            React.createElement(component, props)\n          ) : (\n            <Redirect\n              to={{\n                pathname: \"/login\",\n                state: {\n                  from: props.location,\n                },\n              }}\n            />\n          )\n        }\n      />\n    );\n  }\n\n  function PublicRoute({ component, ...rest } : any) {\n    return (\n      <Route\n        {...rest}\n        render={props =>\n          userState.isAuthenticated ? (\n            <Redirect\n              to={{\n                pathname: \"/\",\n              }}\n            />\n          ) : (\n            React.createElement(component, props)\n          )\n        }\n      />\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}